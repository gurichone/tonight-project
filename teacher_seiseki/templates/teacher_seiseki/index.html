{% extends "teacher/base.html" %}
{% block title %}成績{% endblock%}

{% block modorulink %}{% endblock %}
{% block content %}
    <h2>成績</h2>
    </header>
    <form action="{{ url_for('teacher.seiseki.search') }}" method="POST" novalidate="novalidate">
        {{ score.csrf_token }}
        <!-- 科目名を選ぶ -->
        <label for="subject_id">科目名</label>
        <select name="subject_id" id="subject_id">
            {% for subject_id, label in score.subject_id.choices %}
                <option value="{{ subject_id }}" {% if score.subject_id.data == subject_id %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>
        <!-- クラス番号を選ぶ -->
        <label for="class_num">クラス番号</label>
        <select name="class_num" id="class_num">
            {% for class_num, label in score.class_num.choices %}
                <option value="{{ class_num }}" {% if score.class_num.data == class_num %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>
        <!-- 生徒番号を入力 -->
        <label for="student_name">生徒名</label>
        <input type="text" name="student_name" id="student_name" value="{{ score.student_name.data or '' }}">
        <!-- ボタンを押して検索 -->
        {{ score.submit }}
    </form>
    <!-- 検索結果を表示 -->
    {% if results %}
    <table>
        <thead>
            <tr>
                <th>科目名</th>
                <th>氏名</th>
                <th>成績</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for results in results %}
            <tr>
                <td>{{ results.Subject.subject_name }}</td>
                <td>{{ results.Student.student_name }}</td>
                <td>{{ results.Score.assessment_id }}</td>
                <td>
                    <!-- 消去する際はこのボタンを押すことで実行する -->
                    <form action="{{ url_for('teacher.seiseki.delete', score_id=results.Score.score_id) }}" method="POST">
                        <button type="submit" onclick="return confirm('削除してよろしいですか？')">削除</button>
                    </form> 
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <!-- resultsに何もない場合は以下の文を表示 -->
    {% else %}
        <h2>一致する結果がありません</h2>
    {% endif %}
    <form action="{{ url_for('teacher.seiseki.add') }}"><input type="submit" value="成績登録"></form>
    <form action="{{ url_for('teacher.seiseki.attend') }}"><input type="submit" value="出席確認"></form>
{% endblock %}